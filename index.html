<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Notus Labs API PoC – DX Research</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <header>
      <h1>Notus Labs API PoC – Testes de Developer Experience</h1>
      <p style="text-align: center; margin-bottom: 20px; color: white;">
        Este PoC demonstra os principais problemas de Developer Experience (DX) identificados na API da Notus Labs.<br>
        <strong>Detalhes completos estão nos relatórios anexos.</strong>
      </p>

      <!-- Botões de navegação -->
      <div class="nav-buttons">
        <button class="nav-btn" onclick="window.open('https://docs.notus.team/docs/guides', '_blank')">
          DOCUMENTAÇÃO
        </button>
        <button class="nav-btn" onclick="window.open('https://atlantic-uncle-84c.notion.site/Notus-Labs-DX-Research-2646c57a9e238006bb95dbd8a7aaf3a0', '_blank')">
          DX RESEARCH
        </button>
        <button class="nav-btn" onclick="window.open('https://dashboard.notus.team/org/2815df2a-a07c-440d-9590-079e85583f8a', '_blank')">
          DASHBOARD
        </button>
      </div>

      <!-- Botões para relatórios -->
      <div class="report-buttons">
        <button class="report-btn" onclick="window.open('documentos/Diário de Bordo 1.pdf', '_blank')">Diário #1</button>
        <button class="report-btn" onclick="window.open('documentos/Diário de Bordo 2.pdf', '_blank')">Diário #2</button>
        <button class="report-btn" onclick="window.open('documentos/Diário de Bordo 3.pdf', '_blank')">Diário #3</button>
        <button class="report-btn" onclick="window.open('documentos/Diário de Bordo 4.pdf', '_blank')">Diário #4</button>
        <button class="report-btn" onclick="window.open('documentos/Diário de Bordo 5.pdf', '_blank')">Diário #5</button>
        <button class="report-btn final" onclick="window.open('documentos/Relatório Final.pdf', '_blank')">Relatório Final</button>
      </div>

      <!-- API Key -->
      <label>
        API Key:
        <input type="password" id="apiKey" placeholder="Insira sua API Key" />
      </label>
      <button onclick="saveApiKey()">Salvar</button>
    </header>

    <!-- ROTA 1: GET /wallets/address -->
    <section class="test-card">
      <h3>ROTA 1: GET /wallets/address</h3>
      <p><strong>Problema:</strong> Não funciona só com <code>address</code>. Exige também <code>externallyOwnedAccount</code> e <code>factory</code>.</p>
      <label>address</label>
      <input type="text" id="r1_address" placeholder="0x..." />
      <label>externallyOwnedAccount (opcional para teste)</label>
      <input type="text" id="r1_eoa" placeholder="0x..." />
      <label>factory (opcional para teste)</label>
      <input type="text" id="r1_factory" placeholder="0x..." />
      <button onclick="testRoute1()">Executar</button>
      <pre id="result-r1"></pre>
    </section>

    <!-- ROTA 2: POST /wallets/register -->
    <section class="test-card">
      <h3>ROTA 2: POST /wallets/register</h3>
      <p><strong>Problemas:</strong> Mensagem genérica para EOA inválido; <code>salt</code> padrão não documentado; erro 403 impreciso sem API key.</p>
      <label>externallyOwnedAccount</label>
      <input type="text" id="r2_eoa" placeholder="0x..." />
      <label>factory</label>
      <input type="text" id="r2_factory" placeholder="0x..." />
      <label>salt (opcional)</label>
      <input type="text" id="r2_salt" placeholder="" />
      <button onclick="testRoute2()">Executar</button>
      <pre id="result-r2"></pre>
    </section>

    <!-- ROTA 3: POST /wallets/{address}/deposit -->
    <section class="test-card">
      <h3>ROTA 3: POST /wallets/{address}/deposit</h3>
      <p><strong>Problema:</strong> Saldo insuficiente → <code>500</code> em vez de <code>400</code>.</p>
      <label>smart_wallet_address</label>
      <input type="text" id="r3_address" placeholder="0x..." />
      <label>token (ERC-20)</label>
      <input type="text" id="r3_token" placeholder="0x..." />
      <label>amount</label>
      <input type="text" id="r3_amount" placeholder="1000000" />
      <label>chainId</label>
      <input type="number" id="r3_chain" placeholder="1" />
      <label>fromAddress</label>
      <input type="text" id="r3_from" placeholder="0x..." />
      <button onclick="testRoute3()">Executar</button>
      <pre id="result-r3"></pre>
    </section>

    <!-- ROTA 4: PATCH /wallets/{address}/metadata -->
    <section class="test-card">
      <h3>ROTA 4: PATCH /wallets/{address}/metadata</h3>
      <p><strong>Problema:</strong> Confirma que <code>GET /wallets/address</code> ignora o parâmetro <code>address</code> (sempre retorna salt=0).</p>
      <label>smart_wallet_address</label>
      <input type="text" id="r4_address" placeholder="0x..." />
      <label>metadata (JSON object)</label>
      <textarea id="r4_meta" placeholder='{"name":"Minha Wallet"}'></textarea>
      <button onclick="testRoute4()">Executar</button>
      <pre id="result-r4"></pre>
    </section>

    <!-- ROTA 5: PATCH /wallets/transactions/{id}/metadata -->
    <section class="test-card">
      <h3>ROTA 5: PATCH /wallets/transactions/{id}/metadata</h3>
      <p><strong>Problema:</strong> Aceita apenas <code>string</code>, não objeto JSON (inconsistente com rota 4).</p>
      <label>transactionId</label>
      <input type="text" id="r5_id" placeholder="tx-123" />
      <label>metadata (string)</label>
      <input type="text" id="r5_meta" placeholder="Test transaction" />
      <button onclick="testRoute5()">Executar</button>
      <pre id="result-r5"></pre>
    </section>

    <!-- ROTA 6: POST /kyc/.../standard -->
    <section class="test-card">
      <h3>ROTA 6: POST /kyc/individual-verification-sessions/standard</h3>
      <p><strong>Problema:</strong> Documentação diz que campos são opcionais, mas API exige todos.</p>
      <button onclick="testRoute6()">Executar (com campos mínimos)</button>
      <pre id="result-r6"></pre>
    </section>

    <!-- ROTA 7: POST /fiat/deposit/quote -->
    <section class="test-card">
      <h3>ROTA 7: POST /fiat/deposit/quote</h3>
      <p><strong>Problema:</strong> Retorna <code>403</code> se conta não estiver habilitada para Fiat (requer KYC aprovado + aprovação manual).</p>
      <button onclick="testRoute7()">Executar</button>
      <pre id="result-r7"></pre>
    </section>
  </div>

  <script src="script.js"></script>
</body>
</html>