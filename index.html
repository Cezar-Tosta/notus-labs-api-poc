<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Notus Labs API Tester (PoC)</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Notus Labs API Tester (PoC)</h1>
    <label>
      API Key:
      <input type="password" id="apiKey" placeholder="Insira sua API Key" />
    </label>
    <button onclick="saveApiKey()">Salvar</button>
  </header>

  <!-- Smart Wallets -->
  <section>
    <h2>üîπ Smart Wallets</h2>

    <div class="test-card">
      <h3>POST /wallets/register</h3>
      <p><strong>O que faz:</strong> Cria uma nova Smart Wallet.</p>
      <p><strong>Erro esperado:</strong> `WALLET_ALREADY_REGISTERED`, `FACTORY_NOT_SUPPORTED`, `403` sem API key.</p>
      <input type="text" id="eoa" placeholder="EOA (0x...)" />
      <input type="text" id="factory" placeholder="Factory (0x...)" />
      <input type="text" id="salt" placeholder="Salt (opcional)" />
      <button onclick="testWalletRegister()">Executar</button>
      <pre id="result-wallet-register"></pre>
    </div>

    <div class="test-card">
      <h3>GET /wallets/address</h3>
      <p><strong>O que faz:</strong> Consulta wallet por endere√ßo (requer EOA + factory).</p>
      <p><strong>Erro esperado:</strong> Ignora `address`; sempre retorna wallet com `salt=0`.</p>
      <input type="text" id="getAddress" placeholder="Endere√ßo da wallet (0x...)" />
      <input type="text" id="getEoa" placeholder="EOA (0x...)" />
      <input type="text" id="getFactory" placeholder="Factory (0x...)" />
      <button onclick="testWalletGet()">Executar</button>
      <pre id="result-wallet-get"></pre>
    </div>

    <div class="test-card">
      <h3>GET /wallets</h3>
      <p><strong>O que faz:</strong> Lista todas as wallets do projeto.</p>
      <button onclick="testWalletList()">Executar</button>
      <pre id="result-wallet-list"></pre>
    </div>

    <div class="test-card">
      <h3>GET /wallets/{address}/portfolio</h3>
      <p><strong>O que faz:</strong> Retorna tokens e NFTs da wallet.</p>
      <p><strong>Erro esperado:</strong> `500` intermitente; arrays vazios se sem ativos.</p>
      <input type="text" id="portfolioAddress" placeholder="Endere√ßo da wallet (0x...)" />
      <button onclick="testPortfolio()">Executar</button>
      <pre id="result-portfolio"></pre>
    </div>

    <div class="test-card">
      <h3>GET /wallets/{address}/history</h3>
      <p><strong>O que faz:</strong> Retorna transa√ß√µes on-chain.</p>
      <p><strong>Observa√ß√£o:</strong> N√£o inclui KYC ou Fiat.</p>
      <input type="text" id="historyAddress" placeholder="Endere√ßo da wallet (0x...)" />
      <button onclick="testHistory()">Executar</button>
      <pre id="result-history"></pre>
    </div>

    <div class="test-card">
      <h3>POST /wallets/{address}/deposit</h3>
      <p><strong>O que faz:</strong> Simula dep√≥sito de token ERC-20.</p>
      <p><strong>Erro esperado:</strong> `500` em vez de `400` para saldo insuficiente.</p>
      <input type="text" id="depositAddress" placeholder="Endere√ßo da wallet (0x...)" />
      <input type="text" id="tokenAddress" placeholder="Token ERC-20 (ex: USDC)" />
      <input type="number" id="depositAmount" placeholder="Amount (em unidades m√≠nimas)" />
      <input type="number" id="chainId" placeholder="Chain ID (ex: 1)" />
      <input type="text" id="fromAddress" placeholder="From Address (EOA)" />
      <button onclick="testDeposit()">Executar</button>
      <pre id="result-deposit"></pre>
    </div>

    <div class="test-card">
      <h3>PATCH /wallets/{address}/metadata</h3>
      <p><strong>O que faz:</strong> Atualiza metadados da wallet com objeto JSON.</p>
      <input type="text" id="metaWalletAddress" placeholder="Endere√ßo da wallet (0x...)" />
      <textarea id="walletMetadata" placeholder='{"name":"Minha Wallet","tag":"test"}'></textarea>
      <button onclick="testUpdateWalletMetadata()">Executar</button>
      <pre id="result-wallet-meta"></pre>
    </div>

    <div class="test-card">
      <h3>PATCH /wallets/transactions/{id}/metadata</h3>
      <p><strong>O que faz:</strong> Atualiza metadados de transa√ß√£o com string.</p>
      <p><strong>Erro esperado:</strong> `400` se enviar objeto em vez de string.</p>
      <input type="text" id="txId" placeholder="Transaction ID" />
      <input type="text" id="txMetadata" placeholder="Metadata (string)" />
      <button onclick="testUpdateTxMetadata()">Executar</button>
      <pre id="result-tx-meta"></pre>
    </div>
  </section>

  <!-- KYC -->
  <section>
    <h2>üîπ KYC</h2>

    <div class="test-card">
      <h3>POST /kyc/individual-verification-sessions/standard</h3>
      <p><strong>O que faz:</strong> Cria sess√£o KYC.</p>
      <p><strong>Erro esperado:</strong> `400` se faltar campos obrigat√≥rios (documenta√ß√£o inconsistente).</p>
      <button onclick="testKycCreate()">Executar</button>
      <pre id="result-kyc-create"></pre>
    </div>

    <div class="test-card">
      <h3>GET /kyc/individual-verification-sessions/standard/{sessionId}</h3>
      <p><strong>O que faz:</strong> Consulta status da sess√£o KYC.</p>
      <input type="text" id="kycSessionId" placeholder="Session ID" />
      <button onclick="testKycGet()">Executar</button>
      <pre id="result-kyc-get"></pre>
    </div>

    <div class="test-card">
      <h3>POST /kyc/.../{sessionId}/process</h3>
      <p><strong>O que faz:</strong> Inicia processamento da sess√£o KYC.</p>
      <p><strong>Observa√ß√£o:</strong> Retorna `204`, mas falha assincronamente se n√£o houver documentos.</p>
      <input type="text" id="kycProcessId" placeholder="Session ID" />
      <button onclick="testKycProcess()">Executar</button>
      <pre id="result-kyc-process"></pre>
    </div>
  </section>

  <!-- Fiat -->
  <section>
    <h2>üîπ Fiat</h2>

    <div class="test-card">
      <h3>POST /fiat/deposit/quote</h3>
      <p><strong>O que faz:</strong> Cria cota√ß√£o para dep√≥sito fiat ‚Üí crypto.</p>
      <p><strong>Erro esperado:</strong> `403 Forbidden` se KYC n√£o aprovado ou sem habilita√ß√£o.</p>
      <button onclick="testFiatQuote()">Executar</button>
      <pre id="result-fiat-quote"></pre>
    </div>
  </section>

  <script src="script.js"></script>
</body>
</html>